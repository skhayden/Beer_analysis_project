{
    "collab_server" : "",
    "contents" : "\n# DDS Case Study 1\n\nbeers_df = read.csv(\"Beers.csv\")\n\nhead(beers_df)\nsummary(beers_df)\nstr (beers_df)\n\nbreweries_df = read.csv(\"Breweries.csv\")\n\nhead(breweries_df)\nsummary(breweries_df)\nstr (breweries_df)\n\n# Clean Data, Make the column name Brewery_id same for both data set.\n\n\ncolnames(breweries_df)[which(names(breweries_df) == \"Brew_ID\")] <- \"Brewery_ID\"\ncolnames(breweries_df)[which(names(breweries_df) == \"Name\")] <- \"Brewery_Name\"\n\ncolnames(beers_df)[which(names(beers_df) == \"Brewery_id\")] <- \"Brewery_ID\"\ncolnames(beers_df)[which(names(beers_df) == \"Name\")] <- \"Beer_Name\"\n\n# 1. How many breweries are present in each state?\n\n#Load below packages\ninstall.packages(\"sqldf\")\ninstall.packages(\"RSQLite\")\ninstall.packages(\"tcltk2\")\nlibrary(\"sqldf\")\nlibrary(\"RSQLite\")\nlibrary(\"tcltk2\")\n\nsessionInfo()\n#----------------\n\nbrew_count = (sqldf(\"SELECT count(Brewery_ID) as BreweriesCount, State FROM breweries_df GROUP By State\"))\nbrew_count\n\nhead(brew_count)\n\n#------Try Other ways----to get the count\ninstall.packages(\"data.table\")\nlibrary(\"data.table\")\n\nbdf = data.table(breweries_df)\n\nbdf[ , .N, by = .( State) ]\n\n\n#df$count <- unsplit(lapply(split(breweries_df, breweries_df[c(\"Brewery_ID\")]), nrow), df[c(\"State\")])\n#df$count\n\n#?colSums\n\n#------Try Other ways----\n\n# 2. Merge beer data with the breweries data. \n# Print the first 6 observations and the last six observations to check the merged file.\n\nbeer_brew_merge = merge(beers_df, breweries_df, by = c(\"Brewery_ID\"), na.rm=TRUE)\n\nhead(beer_brew_merge)\n\ntail(beer_brew_merge)\n\n# 3. Report the number of NA's in each column.\n\ncolSums(is.na(beer_brew_merge))\n\n# rowSums(is.na(beer_brew_merge)) # for no of NA's in each row\n\n# 4. Compute the median alcohol content and international bitterness unit for each state. \n# Plot a bar chart to compare. \n\nABV_IBU_Median = (sqldf(\"SELECT median(ABV) as ABV_Median,median(IBU) as IBU_Median, State FROM beer_brew_merge GROUP By State\"))\n\nhead(ABV_IBU_Median)\n\n\n\nbarplot( ABV_IBU_Median$ABV_Median,col=c(\"darkblue\"),space = 1,\n     main=\"ABV Median vs State\", # Title\n     xlab=\"ABV Median\" ,         # xaxis label \n     names.arg = ABV_IBU_Median$State) \n\nbarplot( ABV_IBU_Median$IBU_Median,col=c(\"red\"),space = 1,\n         main=\"IBU Median vs State\", # Title\n         xlab=\"IBU Median\",          # xaxis label \n         names.arg = ABV_IBU_Median$State)\n\n\n# 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?\n\n\nbbm = data.table(beer_brew_merge)\n\nstr(bbm)\n\n# na.omit(bbm, cols = \"ABV\")\n\nmax_ABV <- max(bbm[, ABV],na.rm = TRUE)\n\nmax(bbm$ABV,na.rm = TRUE)\n\nbbm[ABV == max_ABV,.(State,ABV)]\n\nbbm[ABV == (max(bbm$ABV,na.rm = TRUE)),.(State,ABV)]\n\n\n\nmax_ibu = max(bbm[, IBU], na.rm = TRUE)\n\nbbm[IBU == max_ibu, .(State, IBU)]\n\n\n\n# 6. Summary statistics for the ABV variable\n\nsummary(beer_brew_merge$ABV, na.rm = TRUE)\n\n\n# 7. Is there an apparent relationship between the bitterness of the beer and its alcoholic\n# content? Draw a scatter plot.\n# You are welcome to use the ggplot2 library for graphs. Please ignore missing values in\n# your analysis. Make your best judgment of a relationship and EXPLAIN your answer.\n\n\n\n#import data\n\n\n# Data Frame -> Low = 1, Low-Medium = 2, Medium-High = 3, High = 4\n\ndf1 = data.frame(beer_brew_merge, na.rm = TRUE)\n\nhead(df1)\n\nstr(df1)\n\n#Linear reg\n\nregressor = lm(formula = IBU ~ ABV, data=df1 )\nregressor\n\n#predict\ny_pred = predict(regressor, newdata = df1 )\ny_pred\n\n#ggplot\ninstall.packages(\"ggplot2\",dependencies = TRUE)\nlibrary(ggplot2)\n#install.packages(\"gtable\")\n#library(gtable)\n#install.packages(\"labeling\")\n#library(labeling)\n\n\nggplot() +\n  geom_point(aes(x= df1$ABV, y= df1$IBU),\n             colour='red', na.rm = TRUE,size = .75)+\n  geom_line(aes(x= df1$ABV,y= predict(regressor, newdata = df1 )),\n            colour='blue',na.rm = TRUE)+\n  ggtitle('ABV vs IBU')+\n  xlab('ABV')+\n  ylab('IBU')\n\n?ggplot\n\n# Yes there is a linear correlation between alcholol content and the bitterness of the beer\n# as the alcholol content increases and the bitterness of the beer also increases.\n\n#----Done---\n\n\n",
    "created" : 1507781323619.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4091354604",
    "id" : "3D6F3FE4",
    "lastKnownWriteTime" : 1507609023,
    "last_content_update" : 1507609023,
    "path" : "~/GitHub/SMU/Doing_Data_Science_1/CaseStudy/Beer analysis project/analysis/CaseStudy1.R",
    "project_path" : "analysis/CaseStudy1.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}